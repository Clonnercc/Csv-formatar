<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Conversor Profissional CSV</title>

<style>
body{
    font-family: Arial, sans-serif;
    background:#f4f6f9;
    padding:20px;
}

h2{
    margin-bottom:10px;
}

textarea{
    width:100%;
    height:220px;
    padding:10px;
    margin-bottom:10px;
    border-radius:6px;
    border:1px solid #ccc;
    font-size:14px;
}

button{
    padding:10px 15px;
    margin:5px 5px 5px 0;
    border:none;
    border-radius:6px;
    cursor:pointer;
    font-weight:bold;
}

.btn-gerar{background:#2563eb;color:white;}
.btn-copiar{background:#16a34a;color:white;}
.btn-baixar{background:#9333ea;color:white;}

.info{
    font-size:13px;
    color:#555;
    margin-bottom:10px;
}
</style>
</head>

<body>

<h2>Conversor de Lista para CSV (Alta Capacidade)</h2>

<div class="info">
✔ Sem limite prático de caracteres<br>
✔ Suporta milhares de linhas<br>
✔ Remove automaticamente " e |<br>
✔ Converte para CSV padrão
</div>

<textarea id="entrada" placeholder="Cole aqui sua lista grande..."></textarea>

<button class="btn-gerar" onclick="gerarCSV()">Gerar CSV</button>
<button class="btn-copiar" onclick="copiarCSV()">Copiar CSV</button>
<button class="btn-baixar" onclick="baixarCSV()">Baixar .csv</button>

<h3>Resultado CSV</h3>
<textarea id="saidaCSV" readonly></textarea>

<script>

let csvFinal = "";

function limparLinha(linha){
    return linha
        .replace(/"/g,"")
        .replace(/\|/g,",")
        .trim();
}

function gerarCSV(){

    const entrada = document.getElementById("entrada").value;

    if(!entrada.trim()){
        alert("Cole a lista primeiro.");
        return;
    }

    const linhas = entrada.split(/\r?\n/);

    let resultado = [];
    resultado.push("Nome,CPF,Telefone,Endereco,Banco,Agencia,Conta");

    for(let i = 0; i < linhas.length; i++){

        let linha = linhas[i];
        if(!linha.trim()) continue;

        linha = limparLinha(linha);

        resultado.push(linha);
    }

    csvFinal = resultado.join("\n");

    document.getElementById("saidaCSV").value = csvFinal;

    alert("Lista processada com sucesso! Total de linhas: " + (resultado.length - 1));
}

function copiarCSV(){

    if(!csvFinal){
        alert("Gere o CSV primeiro.");
        return;
    }

    navigator.clipboard.writeText(csvFinal)
    .then(() => alert("CSV copiado com sucesso!"))
    .catch(() => alert("Erro ao copiar."));
}

function baixarCSV(){

    if(!csvFinal){
        alert("Gere o CSV primeiro.");
        return;
    }

    const blob = new Blob([csvFinal], { type: "text/csv;charset=utf-8;" });
    const link = document.createElement("a");

    link.href = URL.createObjectURL(blob);
    link.download = "lista_grande.csv";
    link.click();
}

</script>

</body>
</html>
